{% extends "base.html" %}
{% block user %}{{ User }}{% endblock %}
{% block title %}时段统计<br /><small></small>{% endblock %}
{% block content %}
<form class="form-inline" action="" method="post">
  <p class="text-center">
    <input name="year_begin" class="span1" type="text" id="year_begin" value="{% if date_begin %}{{ date_begin.split('-')[0] }}{% endif %}">
    <label for="year_begin">年</label>
    <select name="month_begin" class="span2">
      <option value="01"{% if date_begin.split('-')[1] == '01' %} selected{% endif %}>一月</option>
      <option value="02"{% if date_begin.split('-')[1] == '02' %} selected{% endif %}>二月</option>
      <option value="03"{% if date_begin.split('-')[1] == '03' %} selected{% endif %}>三月</option>
      <option value="04"{% if date_begin.split('-')[1] == '04' %} selected{% endif %}>四月</option>
      <option value="05"{% if date_begin.split('-')[1] == '05' %} selected{% endif %}>五月</option>
      <option value="06"{% if date_begin.split('-')[1] == '06' %} selected{% endif %}>六月</option>
      <option value="07"{% if date_begin.split('-')[1] == '07' %} selected{% endif %}>七月</option>
      <option value="08"{% if date_begin.split('-')[1] == '08' %} selected{% endif %}>八月</option>
      <option value="09"{% if date_begin.split('-')[1] == '09' %} selected{% endif %}>九月</option>
      <option value="10"{% if date_begin.split('-')[1] == '10' %} selected{% endif %}>十月</option>
      <option value="11"{% if date_begin.split('-')[1] == '11' %} selected{% endif %}>十一月</option>
      <option value="12"{% if date_begin.split('-')[1] == '12' %} selected{% endif %}>十二月</option>
    </select>
    <label for="month_begin">月</label>
    <select name='day_begin' class="span1">
      <option value="01"{% if date_begin.split('-')[2] == '01' %} selected{% endif %}>1</option>
      <option value="02"{% if date_begin.split('-')[2] == '02' %} selected{% endif %}>2</option>
      <option value="03"{% if date_begin.split('-')[2] == '03' %} selected{% endif %}>3</option>
      <option value="04"{% if date_begin.split('-')[2] == '04' %} selected{% endif %}>4</option>
      <option value="05"{% if date_begin.split('-')[2] == '05' %} selected{% endif %}>5</option>
      <option value="06"{% if date_begin.split('-')[2] == '06' %} selected{% endif %}>6</option>
      <option value="07"{% if date_begin.split('-')[2] == '07' %} selected{% endif %}>7</option>
      <option value="08"{% if date_begin.split('-')[2] == '08' %} selected{% endif %}>8</option>
      <option value="09"{% if date_begin.split('-')[2] == '09' %} selected{% endif %}>9</option>
      {% for i in range(10, 32) %}
      <option value="{{ i }}"{% if date_begin.split('-')[2] == i|string() %} selected{% endif %}>{{ i }}</option>
      {% endfor %}
    </select>
    <label for="day_begin">日</label>
    <span class="label label-info">至</span>
    <input name="year_end" class="span1" type="text" id="year_end" value="{% if date_end %}{{ date_end.split('-')[0] }}{% endif %}">
    <label for="year_end">年</label>
    <select name="month_end" class="span2">
      <option value="01"{% if date_end.split('-')[1] == '01' %} selected{% endif %}>一月</option>
      <option value="02"{% if date_end.split('-')[1] == '02' %} selected{% endif %}>二月</option>
      <option value="03"{% if date_end.split('-')[1] == '03' %} selected{% endif %}>三月</option>
      <option value="04"{% if date_end.split('-')[1] == '04' %} selected{% endif %}>四月</option>
      <option value="05"{% if date_end.split('-')[1] == '05' %} selected{% endif %}>五月</option>
      <option value="06"{% if date_end.split('-')[1] == '06' %} selected{% endif %}>六月</option>
      <option value="07"{% if date_end.split('-')[1] == '07' %} selected{% endif %}>七月</option>
      <option value="08"{% if date_end.split('-')[1] == '08' %} selected{% endif %}>八月</option>
      <option value="09"{% if date_end.split('-')[1] == '09' %} selected{% endif %}>九月</option>
      <option value="10"{% if date_end.split('-')[1] == '10' %} selected{% endif %}>十月</option>
      <option value="11"{% if date_end.split('-')[1] == '11' %} selected{% endif %}>十一月</option>
      <option value="12"{% if date_end.split('-')[1] == '12' %} selected{% endif %}>十二月</option>
    </select>
    <label for="month_end">月</label>
    <select name='day_end' class="span1">
      <option value="01"{% if date_end.split('-')[2] == '01' %} selected{% endif %}>1</option>
      <option value="02"{% if date_end.split('-')[2] == '02' %} selected{% endif %}>2</option>
      <option value="03"{% if date_end.split('-')[2] == '03' %} selected{% endif %}>3</option>
      <option value="04"{% if date_end.split('-')[2] == '04' %} selected{% endif %}>4</option>
      <option value="05"{% if date_end.split('-')[2] == '05' %} selected{% endif %}>5</option>
      <option value="06"{% if date_end.split('-')[2] == '06' %} selected{% endif %}>6</option>
      <option value="07"{% if date_end.split('-')[2] == '07' %} selected{% endif %}>7</option>
      <option value="08"{% if date_end.split('-')[2] == '08' %} selected{% endif %}>8</option>
      <option value="09"{% if date_end.split('-')[2] == '09' %} selected{% endif %}>9</option>
      {% for i in range(10, 32) %}
      <option value="{{ i }}"{% if date_end.split('-')[2] == i|string() %} selected{% endif %}>{{ i }}</option>
      {% endfor %}
    </select>
    <label for="day_end">日</label>
    <button class="btn btn-primary" value="submit">确认</button>
  </p>
</form>
<div class="row-fluid">
  <div class="span8 offset2">
    <div id="container" style="height:2000px"></div>
  </div>
  <!-- <div class="span2">
    <h4>查看详细</h4>
    <ul>
      {% for row in rows %}
      <li><a href="/chaxun/scan_log?user_id={{ row.id }}&date_begin={{ date_begin }}&date_end={{ date_end }}">{{ row.MingCheng }}</a></li>
      {% endfor %}
    </ul>
  </div> -->
</div>
{% endblock %}
{% block jslib %}
<script src="/static/highcharts/4.0.1/highcharts.js"></script>
<script>
$(function () {
    $('#container').highcharts({
        chart: {
            type: 'bar'
        },
        title: {
            text: '时段操作统计 {{ date_begin }}至{{ date_end }}'
        },
        subtitle: {
            text: '数据内容为扫描并上传档案的份数'
        },
        xAxis: {
            categories: [
            {%- for row in rows -%}
                {%- if loop.last -%}
                '{{ row.MingCheng }}'
                {%- else -%}
                '{{ row.MingCheng }}',
                {%- endif -%}
            {%- endfor -%}
            ]
        },
        yAxis: {
            title: {
                text: '数量'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    enabled: true
                },
                enableMouseTracking: false
            }
        },
        series: [{
            name: '时段操作统计 {{ date_begin }}至{{ date_end }}',
            data: [
            {%- for row in rows -%}
                {%- if loop.last -%}
                {{ row.counter }}
                {%- else -%}
                {{ row.counter }},
                {%- endif -%}
            {%- endfor -%}
            ]
        }]
    });
});
</script>
{% endblock %}
